<!DOCTYPE html>
<html>
<head>
    <title>atitle</title>
</head>
<body>


<select id="selectDevice">
    <option value=" ">Select</option>
    {{range .Buttons}}
    <option value="{{.}}">{{.}}</option>
    {{ end }}
</select>


<button id="toggleButton">Resume Capture</button>

<div id="content"></div>
<script>
    const contentElement = document.getElementById("content");

    const eventSource = new EventSource("/updatePackets");

    eventSource.onmessage = function(event) {
        console.log(event.data);
        // contentElement.textContent = event.data + "\n" + contentElement.textContent;
        contentElement.textContent = event.data;
    };


    let isCapturing = false;

    document.getElementById('toggleButton').addEventListener('click', function() {
        fetch(isCapturing ? '/pause' : '/resume')
            .then(response => {
                if (response.ok) {
                    isCapturing = !isCapturing;
                    document.getElementById('toggleButton').innerText = isCapturing ? 'Pause Capture' : 'Resume Capture';
                }
            })
            .catch(error => console.error('Error toggling capture:', error));
    });

    document.getElementById('selectDevice').addEventListener('change', function() {
        fetch("/selectDevice", {
            method: "POST",  // Change this to POST
            body: document.getElementById('selectDevice').value,
        })
            .then(response => {
                if (response.ok) {
                    isCapturing = true;  // Pause capture when changing devices
                    document.getElementById('toggleButton').innerText = 'Pause Capture';
                }
            })
            .catch(error => console.error('Error selecting device:', error));
    });


</script>
</body>
</html>
